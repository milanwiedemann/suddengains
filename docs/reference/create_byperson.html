<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create a data set with one gain per person — create_byperson • suddengains</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create a data set with one gain per person — create_byperson" />
<meta property="og:description" content="This function returns a wide data set with one row for each case in data.
The data set includes variables indicating whether each case experienced a sudden gain/loss or not,
values around the period of each gain/loss, and descriptives.
For cases with no sudden gain/loss the descriptive variables are coded as missing (NA)." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">suddengains</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/suddengains-tutorial.html">A tutorial on using the suddengains R package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a data set with one gain per person</h1>
    
    <div class="hidden name"><code>create_byperson.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function returns a wide data set with one row for each case in <code>data</code>.
The data set includes variables indicating whether each case experienced a sudden gain/loss or not,
values around the period of each gain/loss, and descriptives.
For cases with no sudden gain/loss the descriptive variables are coded as missing (<code>NA</code>).</p>
    </div>

    <pre class="usage"><span class='fu'>create_byperson</span>(
  <span class='no'>data</span>,
  <span class='no'>sg_crit1_cutoff</span>,
  <span class='no'>id_var_name</span>,
  <span class='no'>sg_var_list</span>,
  <span class='no'>tx_start_var_name</span>,
  <span class='no'>tx_end_var_name</span>,
  <span class='no'>sg_measure_name</span>,
  <span class='kw'>multiple_sg_select</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"first"</span>, <span class='st'>"last"</span>, <span class='st'>"smallest"</span>, <span class='st'>"largest"</span>),
  <span class='kw'>data_is_bysg</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>identify</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"sg"</span>, <span class='st'>"sl"</span>),
  <span class='kw'>sg_crit2_pct</span> <span class='kw'>=</span> <span class='fl'>0.25</span>,
  <span class='kw'>sg_crit3</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>sg_crit3_alpha</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,
  <span class='kw'>sg_crit3_adjust</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>sg_crit3_critical_value</span> <span class='kw'>=</span> <span class='fl'>2.776</span>,
  <span class='kw'>identify_sg_1to2</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A data set in wide format including an ID variable and variables for each measurement point.</p></td>
    </tr>
    <tr>
      <th>sg_crit1_cutoff</th>
      <td><p>Numeric, specifying the cut-off value to be used for the first sudden gains criterion.
The function <code><a href='define_crit1_cutoff.html'>define_crit1_cutoff</a></code> can be used to calculate a cutoff value based on the Reliable Change Index (RCI; Jacobson &amp; Truax, 1991).
If set to <code>NULL</code> the first criterion wont be applied.</p></td>
    </tr>
    <tr>
      <th>id_var_name</th>
      <td><p>String, specifying the name of the ID variable.</p></td>
    </tr>
    <tr>
      <th>sg_var_list</th>
      <td><p>Vector, specifying the variable names of each measurement point sequentially.</p></td>
    </tr>
    <tr>
      <th>tx_start_var_name</th>
      <td><p>String, specifying the variable name of the first measurement point of the intervention.</p></td>
    </tr>
    <tr>
      <th>tx_end_var_name</th>
      <td><p>String, specifying the variable name of the last measurement point of the intervention.</p></td>
    </tr>
    <tr>
      <th>sg_measure_name</th>
      <td><p>String, specifying the name of the measure used to identify sudden gains/losses.</p></td>
    </tr>
    <tr>
      <th>multiple_sg_select</th>
      <td><p>String, specifying which sudden gain/loss to select for this data set if more than one gain/loss was identified per case.
Options are: <code>"first"</code>, <code>"last"</code>, <code>"smallest"</code>, or <code>"largest"</code>.
The default is to select the first sudden gain (<code>"first"</code>) if someone experienced multiple gains.</p></td>
    </tr>
    <tr>
      <th>data_is_bysg</th>
      <td><p>Logical, specifying whether the data set in the <code>data</code> argument is a bysg datasets created using the <code><a href='create_bysg.html'>create_bysg</a></code> function.</p></td>
    </tr>
    <tr>
      <th>identify</th>
      <td><p>String, specifying whether to identify sudden gains (<code>"sg"</code>) using <code><a href='identify_sg.html'>identify_sg</a></code> or sudden losses (<code>"sl"</code>) using <code><a href='identify_sl.html'>identify_sl</a></code>.
The default is to identify sudden gains (<code>"sg"</code>).</p></td>
    </tr>
    <tr>
      <th>sg_crit2_pct</th>
      <td><p>Numeric, specifying the percentage change to be used for the second sudden gains/losses criterion.
If set to <code>NULL</code> the second criterion wont be applied.</p></td>
    </tr>
    <tr>
      <th>sg_crit3</th>
      <td><p>If set to <code>TRUE</code> the third criterion will be applied automatically adjusting the critical value for missingness.
If set to <code>FALSE</code> the third criterion wont be applied.</p></td>
    </tr>
    <tr>
      <th>sg_crit3_alpha</th>
      <td><p>Numeric, alpha for the student t-test (two-tailed) to determine the critical value to be used for the third criterion.
Degrees of freedom are based on the number of available data in the three sessions preceding the gain and the three sessions following the gain.</p></td>
    </tr>
    <tr>
      <th>sg_crit3_adjust</th>
      <td><p>Logical, specify whether critical value gets adjusted for missingness, see Lutz et al. (2013) and the documentation of this R package for further details.
This argument is set to <code>TRUE</code> by default adjusting the critical value for missingness as described in the package documentation and Lutz et al. (2013):
A critical value of 2.776 is used when all three data points before and after a potential gain are available,
where one datapoint is missing either before or after a potential gain a critical value of 3.182 is used,
and where one datapoint is missing both before and after the gain a critical value of 4.303 is used (for sg_crit3_alpha = 0.05).
If set to <code>FALSE</code> the critical value setin <code>sg_crit3_critical_value</code> will instead be used for all comparisons, regardless of missingnes in the sequence of data points that are investigated for potential sudden gains.</p></td>
    </tr>
    <tr>
      <th>sg_crit3_critical_value</th>
      <td><p>Numeric, specifying the critical value to instead be used for all comparisons, regardless of missingnes in the sequence of data points that are investigated for potential sudden gains.</p></td>
    </tr>
    <tr>
      <th>identify_sg_1to2</th>
      <td><p>Logical, indicating whether to identify sudden losses from measurement point 1 to 2.
If set to TRUE, this implies that the first variable specified in <code>sg_var_list</code> represents a baseline measurement point, e.g. pre-intervention assessment.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A wide data set with one row per case (<code>id_var_name</code>) in <code>data</code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Tang, T. Z., &amp; DeRubeis, R. J. (1999). Sudden gains and critical sessions in cognitive-behavioral therapy for depression. Journal of Consulting and Clinical Psychology, 67(6), 894–904. <a href='https://doi.org/10.1037/0022-006X.67.6.894'>https://doi.org/10.1037/0022-006X.67.6.894</a>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Create byperson data set, selecting the largest gain in case of muliple gains</span>
<span class='fu'>create_byperson</span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>sgdata</span>,
                <span class='kw'>sg_crit1_cutoff</span> <span class='kw'>=</span> <span class='fl'>7</span>,
                <span class='kw'>id_var_name</span> <span class='kw'>=</span> <span class='st'>"id"</span>,
                <span class='kw'>tx_start_var_name</span> <span class='kw'>=</span> <span class='st'>"bdi_s1"</span>,
                <span class='kw'>tx_end_var_name</span> <span class='kw'>=</span> <span class='st'>"bdi_s12"</span>,
                <span class='kw'>sg_var_list</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"bdi_s1"</span>, <span class='st'>"bdi_s2"</span>, <span class='st'>"bdi_s3"</span>,
                                <span class='st'>"bdi_s4"</span>, <span class='st'>"bdi_s5"</span>, <span class='st'>"bdi_s6"</span>,
                                <span class='st'>"bdi_s7"</span>, <span class='st'>"bdi_s8"</span>, <span class='st'>"bdi_s9"</span>,
                                <span class='st'>"bdi_s10"</span>, <span class='st'>"bdi_s11"</span>, <span class='st'>"bdi_s12"</span>),
                <span class='kw'>sg_measure_name</span> <span class='kw'>=</span> <span class='st'>"bdi"</span>,
                <span class='kw'>multiple_sg_select</span> <span class='kw'>=</span> <span class='st'>"largest"</span>)</div><div class='output co'>#&gt; <span class='message'>First, second, and third sudden gains criteria were applied.</span></div><div class='output co'>#&gt; <span class='message'>The critical value for the third criterion was adjusted for missingness.</span></div><div class='output co'>#&gt; <span class='message'>Note: The vector specified in 'extract_var_list' must have the same number of repeated time points as the measure used to identify sudden gains.</span></div><div class='output co'>#&gt; <span class='message'>The largest gain/loss was selected in case of multiple gains/losses.</span></div><div class='output co'>#&gt; <span style='color: #555555;'># A tibble: 43 x 46</span><span>
#&gt;       id id_sg sg_crit123 sg_session_n sg_freq_byperson sg_bdi_2n sg_bdi_1n
#&gt;    </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>      </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>        </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>            </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>     </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>     </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'> 1</span><span>     1 1_sg…          1            7                2        24        21
#&gt; </span><span style='color: #555555;'> 2</span><span>     2 </span><span style='color: #BB0000;'>NA</span><span>             0           </span><span style='color: #BB0000;'>NA</span><span>                0        </span><span style='color: #BB0000;'>NA</span><span>        </span><span style='color: #BB0000;'>NA</span><span>
#&gt; </span><span style='color: #555555;'> 3</span><span>     3 3_sg…          1            8                1        37        </span><span style='color: #BB0000;'>NA</span><span>
#&gt; </span><span style='color: #555555;'> 4</span><span>     4 4_sg…          1            3                1        31        30
#&gt; </span><span style='color: #555555;'> 5</span><span>     5 5_sg…          1            8                2        23        21
#&gt; </span><span style='color: #555555;'> 6</span><span>     6 </span><span style='color: #BB0000;'>NA</span><span>             0           </span><span style='color: #BB0000;'>NA</span><span>                0        </span><span style='color: #BB0000;'>NA</span><span>        </span><span style='color: #BB0000;'>NA</span><span>
#&gt; </span><span style='color: #555555;'> 7</span><span>     7 </span><span style='color: #BB0000;'>NA</span><span>             0           </span><span style='color: #BB0000;'>NA</span><span>                0        </span><span style='color: #BB0000;'>NA</span><span>        </span><span style='color: #BB0000;'>NA</span><span>
#&gt; </span><span style='color: #555555;'> 8</span><span>     8 </span><span style='color: #BB0000;'>NA</span><span>             0           </span><span style='color: #BB0000;'>NA</span><span>                0        </span><span style='color: #BB0000;'>NA</span><span>        </span><span style='color: #BB0000;'>NA</span><span>
#&gt; </span><span style='color: #555555;'> 9</span><span>     9 9_sg…          1            3                1        35        34
#&gt; </span><span style='color: #555555;'>10</span><span>    10 10_s…          1            2                2        </span><span style='color: #BB0000;'>NA</span><span>        35
#&gt; </span><span style='color: #555555;'># … with 33 more rows, and 39 more variables: sg_bdi_n </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, sg_bdi_n1 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>,
#&gt; #   sg_bdi_n2 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, sg_bdi_n3 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, sg_magnitude </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>,
#&gt; #   sg_bdi_tx_change </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, sg_change_proportion </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>,
#&gt; #   sg_reversal_value </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, sg_reversal </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, bdi_s0 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, bdi_s1 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>,
#&gt; #   bdi_s2 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, bdi_s3 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, bdi_s4 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, bdi_s5 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, bdi_s6 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>,
#&gt; #   bdi_s7 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, bdi_s8 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, bdi_s9 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, bdi_s10 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, bdi_s11 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>,
#&gt; #   bdi_s12 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, bdi_fu1 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, bdi_fu2 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, rq_s0 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, rq_s1 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>,
#&gt; #   rq_s2 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, rq_s3 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, rq_s4 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, rq_s5 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, rq_s6 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>,
#&gt; #   rq_s7 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, rq_s8 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, rq_s9 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, rq_s10 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, rq_s11 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>,
#&gt; #   rq_s12 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, rq_fu1 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, rq_fu2 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span></div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Milan Wiedemann, Mental Health Research UK, Wellcome Trust.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


